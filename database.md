---
title: 数据库基础
---

数据库是最常见的服务之一，有商业的Oracle、开源的MySQL/Postgress、单机用的Sqlite等等。

数据库首先都是行存，因为行存是最符合人类直觉的数据库存储方式，比如user表，有userID、姓名、性别、住址、手机号等信息，在数据表里就这样存储：

每行是一条记录，每条记录有上述若干列，每列保存这条记录的一个属性。

这就是后来称为"行存"的存储方式。

那么要找一个人的信息怎么找呢？最简单的就是从头到尾一条条对比，当姓名和你找的一致时，就可以得到这个人的所有信息，但这样太慢了，100万条最多可能找取100万次记录，于是就有了"索引"的概念：

如果经常要用姓名查找记录，则将姓名和userID单独做一个索引表，将姓名按字母顺序排列，这样就可以用折半算法，先看索引表第50万条的姓名比你要找的大还是小，然后再在一半的记录中继续折半查找，这样100万条记录最多只需要20次就可以找到了($2^{20}>100万$)，用找到的userID回到原user表就可直接得到记录(假设userID是连续增的、且每条记录的字节数是固定的)。

索引表和KV(Key-Value)存储类似，比如一个表可以用手机号作为key，其他的信息都存在一个字符串中，字符串可能是这样"姓名:xxx, 性别:x, 住址:xxx"，这样的存储当使用手机号做key检索时是极快的。

互联网大数据时代来临后，发现一个重大问题：比如一个数据库记录访问我的网站的行为，可能有成百上千的行为需要记录，但其实每个用户可能经常出现的只有很少几个行为，这样就导致库中大量的数据是空的，即所谓的数据"稀疏"。这样的数据使用行存不仅浪费存储空间，而且因为行存每次要提取整条记录，也浪费了计算能力和内存。同时，在这类应用中，经常要取得的是用户的某个或某几个行为，而不需要得到用户的所有行为。为了解决这几个问题，"列存"就出现了，列存只获取需要的列，而不是所有列。


